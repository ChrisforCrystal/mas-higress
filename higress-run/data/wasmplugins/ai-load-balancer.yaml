apiVersion: extensions.higress.io/v1alpha1
kind: WasmPlugin
metadata:
  name: ai-load-balancer
  namespace: higress-system
spec:
  priority: 200
  phase: UNSPECIFIED
  url: file:///data/wasmplugins/ai-load-balancer-go.wasm
  defaultConfig:
    redis:
      service_name: "redis-svc"
      service_port: 6379
      timeout: 2000
    redis_key_prefix: "ai_metric:"
    providers:
      - name: "minmax"
        key: "minimax_1"
        model: "MiniMax-M2.1"
        headers:
          x-higress-llm-model: "MiniMax-M2.1"
      - name: "qianwen"
        key: "qwen_1"
        model: "qwen3-max-preview"
        headers:
          x-lb-dispatch: "qwen-gpu-1"
